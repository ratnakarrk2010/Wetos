@model WetosDB.LeaveApplication
@{
    ViewBag.Title = "Leave Application Edit";
}
@System.Web.Optimization.Styles.Render("~/Content/DatePicker")
@System.Web.Optimization.Scripts.Render("~/bundles/DatePicker")
@System.Web.Optimization.Styles.Render("~/Content/Select2")
   @System.Web.Optimization.Scripts.Render("~/bundles/Select2")
    <link href="~/Content/allcss/allcss.css" rel="stylesheet" />
<div class="page-content-wrapper" id="page_content">
    <div class="page-content">
        <section class="content-header">
        <div class="row page-breadcrumb breadcrumb ed_breadcrumb">
                <div class="col-sm-6">
                    <ul>
                        <li class="li_margin1">
                            <img src="~/Content/images/icon/home_1.png" class="home_width_height" />
                            <a href="@Url.Action("Index", "Home")">Home</a><i class="fa fa-angle-right"></i>

                        </li>
                        <li class="li_margin">
                         <a href="#">Applications</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li class="li_margin">
                            <a href="#">on Behalf of Leave Application</a>
                        </li>
                        </ul>
                </div>
                <div class="col-sm-6">
                    <ul style="float: right;">
                        <li class="">
                            <div id="dashboard-report margin_left" data-toggle="tooltip" title="Today's date">
                                <img src="~/Content/images/icon/imageedit_42.png" class="icon_width_height" />
                                <span>
                                    @DateTime.Now.ToLongDateString()
                                </span>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
 <h1>
 Leave Application
      @* Edit*@
        <small>@*Leave Application*@ 
        Edit</small>
      </h1>
      <!-- <div class="row">
                <div class="col-md-12">
                    <ul class="page-breadcrumb breadcrumb">
                        <li>
                            <i class="fa fa-home"></i>
                            <a href="@Url.Action("Index", "Home")">Home </a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li>
                         <a href="#">Applications</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li>
                            <a href="#">on Behalf of Leave Application</a>
                        </li>
                        <li class="pull-right">
                            <div id="dashboard-report"  data-toggle="tooltip" title="Today's date">
                                <span style="cursor:pointer" class="back "  data-toggle="tooltip" title="Back" id="goback"><i class="fa fa-arrow-left"></i></span>
                                <i class="fa fa-calendar"></i>
                                <span>@DateTime.Now.ToLongDateString()</span>                           
                            </div>
                        </li>              
                    </ul>
                </div>
            </div> -->

       @*Added by Pushkar For back breadcrumb on 24 OCT 2016----------Start*@
      
      <div style="clear: both;"></div>

       @*Added by Pushkar For back breadcrumb on 24 OCT 2016-----------End*@

    </section>
        <br />
        <section class="content">
      <div class="row">
        <div class="col-xs-12 col-md-12 col-lg-12">
          <div class="box box-primary">
           
            <!-- /.box-header -->
          
@using (Html.BeginForm())
{
    
      <div style="color:Red;font-size:12px">
   @Html.ValidationSummary(false)  
   </div>      
    <fieldset>
     <div class="box-body">
     <div class="row">
         
              <div class="col-md-8">

              <div id="EmployeeName" class="form-group">
                Employee Name <span style="color:Red;font-size:18px" >*</span>
            
                 @Html.DropDownListFor(a => a.EmployeeId, (IEnumerable<SelectListItem>)@ViewBag.EmployeeCodeAndNameList, "Select", new { @class = "form-control select2", id = "EmployeeName1", style = "width:500px" })
  
        </div>
              </div>
              </div>
              <br />
              @* Updated on 17 NOV 2016 by Rajas for date display format start *@
              <div class="row">
              <div class="col-md-4">
               <div class="form-group">
               From Date <span style="color:Red;font-size:18px" >*</span>

                <div class="input-group date">
                  <div class="input-group-addon">
                    <i class="fa fa-calendar"></i>
                  </div>
                  <input type="text" class="form-control datepicker" data-date-fomat="dd-MMM-yyyy" name="FromDate" id="FromDate" value="@String.Format("{0:dd-MMM-yyyy}", @Model.FromDate)" />
                  @* @Html.TextBoxFor(model => model.FromDate, new { @class = "form-control pull-right datepicker" })*@
                   
                  
                 @* <input type="text" class="form-control pull-right datepicker" id="FromDate" name="FromDate"/>*@
                </div>
                 @*@Html.ValidationMessageFor(model => model.FromDate)*@
                <!-- /.input group -->
              </div>
              </div>

              <div class="col-md-4">
              <div class="form-group">
              From Day Status  <span style="color:Red;font-size:18px" >*</span> @*Added * By Shraddha on 12 DEC 2016 to show required field *@
              @Html.DropDownListFor(a => a.FromDayStatus, (IEnumerable<SelectListItem>)ViewBag.LeaveTypeStatusList, "Select", new { @class = "form-control select2", id = "LeaveStatusList" })
              </div>
              </div>
              </div>

              <div class="row">
              <div class="col-md-4">
               <div class="form-group">
               To Date  <span style="color:Red;font-size:18px" >*</span>

                <div class="input-group date">
                  <div class="input-group-addon">
                    <i class="fa fa-calendar"></i>
                  </div>
                  <input type="text" class="form-control datepicker" data-date-fomat="dd-MMM-yyyy" name="ToDate" id="ToDate" value="@String.Format("{0:dd-MMM-yyyy}", @Model.ToDate)" />
                   @*   @Html.TextBoxFor(model => model.ToDate, new { @class = "form-control pull-right datepicker" })*@
                     
                 @* <input type="text" class="form-control pull-right datepicker" id="ToDate" name="ToDate"/>*@
                </div>
                @* @Html.ValidationMessageFor(model => model.ToDate)*@
                </div>
                <!-- /.input group -->
              </div>
              @*End*@

               <div class="col-md-4">
              <div class="form-group">
              To Day Status  <span style="color:Red;font-size:18px" >*</span> @*Added * By Shraddha on 12 DEC 2016 to show required field *@
              @Html.DropDownListFor(a => a.ToDayStatus, (IEnumerable<SelectListItem>)ViewBag.LeaveTypeStatusList, "Select", new { @class = "form-control select2", id = "LeaveStatusList" })
              </div>
              </div>
              </div>

              <div class="row"> 
                <div class="col-md-2">
                <div class="form-group">
               Leave Type <span style="color:Red;font-size:18px" >*</span>
               @Html.TextBoxFor(model => model.LeaveType, new { @readonly = "readonly" })
                 @*@Html.DropDownListFor(a => a.LeaveType, (IEnumerable<SelectListItem>)ViewBag.LeaveTypeList, "Select", new { @class = "form-control select2", id = "LeaveTypeList" })*@
                 @*@Html.ValidationMessageFor(model => model.LeaveType)*@
                  @* @Html.TextBoxFor(model => model.LeaveType, new { @class = "form-control pull-right" }) 
            <input type="text" class="form-control pull-right" id="LeaveType" name="LeaveType"/>
                @Html.EditorFor(model => model.LeaveType)
            @Html.ValidationMessageFor(model => model.LeaveType)*@
              </div>
              </div>
              </div>
          
           
              <div class="row">
            <div class="col-md-6">
             <div class="form-group">
               Leave Purpose   <span style="color:Red;font-size:18px" >*</span>
               @*Modified by Shraddha on 19th OCT 2016 for Leave Purpose checkbox*@
              @* @Html.CheckBoxFor(model => model.Purpose,"Medical Leave")
               @Html.CheckBoxFor(model => model.Purpose,"Personal Work")
               @Html.CheckBoxFor(model => model.Purpose,"Medical Leave")*@
               @Html.TextAreaFor(model => model.Purpose, new { @class = "form-control pull-right" })
                  @*@Html.ValidationMessageFor(model => model.Purpose)*@
          @*   <input type="text" class="form-control pull-right" id="Purpose" name="Purpose"/>*@
            @*    @Html.EditorFor(model => model.Purpose)
            @Html.ValidationMessageFor(model => model.Purpose)*@
              </div>
            </div>
           
            </div>
         
          
           <div class="box-footer">
             <p>
            <input type="submit" id="create"  value="Save" class="btn btn-primary"/>
        </p>
       </div>

       <div class="col-md-10">
       <h4>Leave Balance Details As on @DateTime.Now.ToString("dd-MMM-yyyy")</h4>
       <table class="table table-striped" style="width: auto; height: auto;border:1px solid Black;border-collapse:inherit" >
       <tr>
       <td>Leave Type</td>
       <td>Opening Balance</td>
       <td>Leave Used</td>
      <td>Allowed Leaves</td>
       <td>Current Balance</td>
       </tr>

        <tr>
       <td>@ViewBag.LeaveTYpe</td>
       <td align="right">@ViewBag.Opening</td>     @*Modified by Pushkar 0n 6 FEB 2017*@
       <td align="right">@ViewBag.LeaveUsed</td>   @*Modified by Pushkar 0n 6 FEB 2017*@
      <td align="right">@ViewBag.AllowedLeaves</td>@*Modified by Pushkar 0n 6 FEB 2017*@
       
       <td align="right">@ViewBag.CurrentBalance</td> @*Modified by Pushkar 0n 6 FEB 2017*@
       </tr>
       </table>
       </div>

       @*Added by Rajas on 4 NOV 2016 for Leave details table*@

       <div class="col-md-10">
       <h4>Leave Details As on @DateTime.Now.ToString("dd-MMM-yyyy")</h4>
       <table class="table table-striped" style="width: auto; height: auto;border:1px solid Black;border-collapse:inherit" >
       <tr>
       <td>Leave Type</td>
       <td>From Date</td>
       @*<td>From Day Status</td>*@
       <td>To Date</td>
       @*<td>To Day Status</td>*@
        <td>Applied Days</td>
      
      
       
       <td>Paid Leaves</td>
        <td>LWP</td>
      
       </tr>

        <tr>
        <td>@ViewBag.LeaveType</td>
        <td>@ViewBag.FromDate</td>
        @*<td>@ViewBag.FromDayStatus</td>*@
        <td>@ViewBag.ToDate</td>
        @*<td>@ViewBag.ToDateStatus</td>*@
        <td align="right">@ViewBag.AppliedDays</td> @*Modified by Pushkar 0n 6 FEB 2017*@
        
        <td align="right">@ViewBag.PaidLeaves</td> @*Modified by Pushkar 0n 6 FEB 2017*@
        <td align="right">@ViewBag.UnpaidLeaves</td>@*Modified by Pushkar 0n 6 FEB 2017*@

        
        
       </tr>
       </table>
       </div>

      </div>

    </fieldset>
}
          
          
            </div>
         </div>
            </div>
            </section>
    </div>
</div>
<!-- jQuery 2.2.3 -->
<!-- Page script -->
<script src="@Url.Content("~/Scripts/daterangepicker.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/bootstrap-datepicker.js")" type="text/javascript"></script>
@*Added by Pushkar For back breadcrumb on 24 OCT 2016-------start*@
<script type="text/jscript">
    $(document).ready(function () {
        $('a.back').click(function () {
            parent.history.back();
            return false;
        });
    });

    function goBack() {
        window.history.back();
    }



</script>
@*Added by Pushkar For back breadcrumb on 24 OCT 2016---------end*@
<script type="text/javascript">

    $(document).ready(function () {


        $("#Errormsg1").val("");

    });
    $(function () {
        //Initialize Select2 Elements
        $(".select2").select2();

        //Datemask dd/mm/yyyy


        //Date picker
        $('.datepicker').datepicker({

            format: "dd-M-yyyy",

            autoclose: true
        });

    });

    //    Added By Shraddha on 15th OCT 2016 for date Validation Start

    //    $("#create").click(function () {

    //        var fromdate = $("#FromDate").val();
    //        var todate = $("#ToDate").val();
    //        //            var leavepurpose = $("#Purpose").val();
    //        //            var LeaveType = $("#LeaveTypeList").val();
    //        //            alert(LeaveType);

    //        //            if (leavepurpose == null || leavepurpose == "" || todate == "" || todate == null || fromdate == "" || fromdate == null ||
    //        //             LeaveType == null || LeaveType == "") {
    //        //                $("#Errormsg").html("All Fields Are Compulsory");
    //        //                return false;
    //        //            }

    //        if (todate < fromdate) {


    //            $("#Errormsg1").html("To Date is not valid");
    //            alert("error")
    //            return false;
    //        }


    //        else {

    //        }

    //    });
    //    Added By Shraddha on 15th OCT 2016 for date Validation End


</script>
<script type="text/javascript">






    // $('select[name="EmployeeCode1"]').on('change', function() {
    $("#EmployeeCode1").change(function () {
        var EmployeeId = $("#EmployeeCode1").val();

        //alert(EmployeeId);

        $.ajax({
            url: '@Url.Content("~/WetosApplication/AjaxPopulateDropdown")',
            type: "POST",

            data: { EmployeeId: EmployeeId },  // + extractLast(request.term)
            success: function (data) {
                //alert("Selected Text: " + data.EmployeeName + " Value: " + data.EmployeeId);

                $("#EmployeeName1").val(data.EmployeeId).trigger('change');

            }
        });

    });

    function CompareDate() {
        var todate = $("#ToDate").val();
        var fromdate = $("#FromDate").val();
        if (Date.parse(fromdate) > Date.parse(toDate)) {
            alert("Invalid Date Range!\nStart Date cannot be after End Date!")
            return false;
        }
    }

</script>
